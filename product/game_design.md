# Knife Game - Game Design Document

## 1. Концепция

**Название:** Knife Game
**Жанр:** Horror-Rhythm
**Платформа:** PC (Desktop)
**Движок:** Vite + TypeScript + Babylon.js
**Целевая аудитория:** Фанаты инди-хорроров и ритм-игр, 16+

### Описание
Horror-rhythm игра про классическую "knife game" (нож между пальцев). Игрок попадает в ритм музыки, выполняя QTE-последовательности с нарастающей сложностью. Камерная атмосфера за столом, напряжение нагнетается с каждым новым треком — новые механики, быстрее темп, выше ставки.

### Основная механика
QTE-попадание в ритм — игрок нажимает кнопки в такт музыке, управляя ножом между пальцами. Промахи = порезы, слишком много промахов = проигрыш.

### Уникальное торговое предложение (USP)
Скрещивание ритм-геймплея с хоррор-атмосферой в стиле Buckshot Roulette. Короткий, но интенсивный опыт (30-60 минут) с эскалацией механик от трека к треку.

---

## 2. Геймплей

### Основной игровой цикл
Непрерывная игра на прохождение с цикличным челленджем:
1. Начало трека — ввод в новую механику
2. Ритм-фаза — QTE-последовательности под музыку
3. Нарастание сложности внутри трека
4. Завершение трека — переход к следующему с добавлением новой механики
5. Повторение до финального трека

Общая продолжительность: 30-60 минут. Каждый новый трек вводит новый элемент геймплея, сохраняя предыдущие.

### Управление
[TODO: Клавиши для QTE — варианты: WASD / стрелки / пробел / специфичные кнопки]

### Камера
3D камера от первого лица / вид сверху на стол. Камерный ракурс — игрок видит руку, нож и стол. Минимальное движение камеры, дрожание при напряжённых моментах.

### Условия победы / поражения
- **Победа:** пройти все треки до конца
- **Поражение:** слишком много промахов (порезов) в рамках одного трека — game over, рестарт трека

---

## 3. Игровые механики

### Механики по циклам

Каждая новая механика — инструмент, помогающий игроку проходить более сложные треки. Без неё следующий цикл непроходим.

**Цикл 1 — Базовое управление (клавиши 1-5)**
- Удары ножом между пальцев в ритм музыки
- Игрок осваивает кор-механику

**Цикл 2 — Knife tricks (трюки с ножом)**
- Внутри песни чередуются два режима: обычные удары (клавиши 1-5) и трюки с ножом (альтернативное управление)
- Трюки дают больше очков/донатов от чата
- Управление переключается во время одной песни — ритмическое разнообразие
- Без трюков невозможно набрать квоту на более сложных треках

**Цикл 3 — VIP gifts (предметы от зрителей)**
- VIP-чатеры присылают предметы: сигара, виски
- Предметы можно использовать между раундами (в передышках) как перформанс для зрителей
- Перформанс провоцирует больше донатов от чата, помогая набрать квоту
- Стратегический слой: тратишь время передышки на перформанс = больше денег
- [TODO] Возможные побочные эффекты предметов на геймплей (виски размывает управление? сигара расширяет окно тайминга?)

### Прогрессия
Линейная прогрессия через 4 игры в 3 циклах. Сложность растёт за счёт:
- Увеличения темпа (BPM)
- Добавления новых механик-инструментов
- Усложнения паттернов QTE
- Уменьшения окна для попадания в ритм

### Система очков / экономика
Очки = деньги. Попадания в ритм приносят доход. Трюки и перформанс увеличивают множитель через донаты чата. Цель каждого цикла — набрать денежную квоту.

---

## 4. Визуальный стиль

### Арт-направление
Камерный низкополигональный 3D-хоррор. Минималистичная сцена — стол, рука, нож, окружение комнаты. Стилистика в духе Buckshot Roulette: грязные текстуры, тусклое освещение, ощущение замкнутого пространства.

### Цветовая палитра
Тёмные, приглушённые тона. Акценты красного (кровь, опасность). Холодный свет.
[TODO: Конкретная палитра]

### Референсы
- Buckshot Roulette (визуал, атмосфера, камерность)
- Thumper (ритм-хоррор, нарастание интенсивности)
- Five Finger Fillet из RDR2 (механика ножа между пальцев)
- osu! (ритм-механика, система таймингов, окна попадания, фидбек точности)
- Inscryption (нарратив за столом, эскалация ставок, ощущение ловушки, метаигра с "хозяином")

---

## 5. Нарратив

### Сеттинг
ГГ попал в долги и вынужден участвовать в смертельной игре, которая транслируется в прямом эфире. Перед ним на столе — монитор с открытым чатом стрима. Зрители наблюдают, комментируют, донатят и влияют на происходящее.

### Антагонист
Зрители стрима. Не один человек, а анонимная масса. Чат — основной источник давления, насмешек, подстрекательства. Среди массы выделяются VIP-чатеры — второстепенные персонажи с собственными мотивациями (доброжелательные или нет).

### Мотивация ГГ
Закрыть долг. Каждый успешный раунд приближает к погашению. Проигрыш — потеря накопленного и физические последствия.

### Структура
Игра строится на трёх циклах напряжения с 4 играми. Каждый цикл:
1. **Подъём** — нарастание сложности и интенсивности
2. **Пик** — кульминация цикла (игра)
3. **Передышка** — движение нарратива, представление новой механики

### Экономика циклов
Каждый цикл — денежная квота, которую нужно накопить. Квота набирается от успешных попаданий в ритм + донаты от чата. Основное напряжение — успеет ли игрок накопить квоту.

### Карта пейсинга

```
ЦИКЛ 1 — Знакомство
  │ Минимальное напряжение / Старт
  │ "You have a debt to pay"
  │ Camera introduction
  │ Core gameplay introduction
  │ Chat introduction
  ▼
  ██ FIRST GAME (базовое управление, клавиши 1-5)
  │
  │ Reward collecting / Donations
  │ Chat interaction
  │ VIP character(s) introduction
  │
ЦИКЛ 2 — Эскалация
  │ Knife tricks introduction (новая механика)
  ▼
  ██ SECOND GAME (удары + трюки с ножом, альтернативное управление)
  │
  │ Reward collecting / Donations
  │ Chat interaction → VIP gifts
  │ Items introductions (сигара, виски)
  │
  ▼
  ██ THIRD GAME (удары + трюки + предметы от зрителей)
  │
  │ Reward collecting / Donations
  │ Chat interaction → VIP gifts
  │
ФИНАЛ
  │ Dealer speech
  ▼
  ██ LAST GAME (пик напряжения, все механики)
  │
  │ "Your debt is paid. You may keep all the extra money
  │  you've made. You are free to leave now."
  │
  ▼
  ██ LEAVE OR STAY
     ├─ Leave: встаёшь из-за стола → экран гаснет
     └─ Stay: пьёшь виски, куришь, вытаскиваешь нож из стола → экран гаснет
```

### Циклы

**Цикл 1 — Знакомство**
- Базовая механика (клавиши 1-5), только удары
- Игрок учится, ставки минимальны, квота низкая
- Знакомство с чатом и VIP-персонажами
- Пик: First game

**Цикл 2 — Эскалация**
- Новая механика: knife tricks (трюки с ножом, альтернативное управление чередуется с ударами внутри песни)
- Квота выше, чат агрессивнее
- Введение предметов от VIP-чатеров (сигара, виски) — перформанс между раундами за донаты
- Пик: Second game → Third game

**Финал — Кульминация**
- Все механики одновременно
- Dealer speech перед последней игрой
- Максимальное напряжение
- Пик: Last game
- Развилка: Leave or Stay

### Передышки (между играми)
Передышки — активные фазы взаимодействия:
- **Получение денег** за пройденный раунд (визуализация прогресса к квоте)
- **Донаты от чата** — дополнительный доход
- **Предметы от VIP** — сигара, виски (перформанс для зрителей → провокация донатов)
- **ЛС от VIP-чатеров** — короткие диалоги с второстепенными персонажами (советы, угрозы, подстрекательство, сочувствие)
- Представление новой механики следующего раунда

### Финал: Leave or Stay
После оплаты долга дилер объявляет свободу. Игрок выбирает:
- **Leave** — встаёт из-за стола, экран гаснет. ГГ уходит.
- **Stay** — пьёт виски, курит, вытаскивает нож из стола, экран гаснет. ГГ подсел на адреналин.

### VIP-чатеры (второстепенные персонажи)
Выделяются из общей массы чата. Пишут в личные сообщения между раундами. Примеры архетипов:
- Сочувствующий — даёт советы, подбадривает
- Садист — провоцирует, делает ставки против игрока
- Делец — предлагает "помощь" за услуги
- Инсайдер — знает правила, которых не знает игрок
- [TODO] Конкретные персонажи и их арки

### Открытые вопросы
- [DONE] Что происходит после финального пика — развилка Leave or Stay
- [DONE] Конкретные механики для циклов 2 и 3 — knife tricks + VIP gifts
- [TODO] Конкретное альтернативное управление для knife tricks (какие клавиши, какие паттерны)
- [TODO] Побочные эффекты предметов на геймплей (виски / сигара)
- [TODO] Что происходит при провале квоты — game over или наказание и продолжение?
- [TODO] Кто стоит за организацией стрима? Кто такой Dealer?
- [TODO] Конкретные VIP-персонажи и их арки

---

## 6. Звук

### Музыка
[TODO]

### Звуковые эффекты
[TODO]

---

## 7. Техническая часть

### Рендеринг
- Метод: GL Compatibility

### Целевая производительность
[TODO]

### Минимальные требования
[TODO]

---

## 8. Scope и приоритеты

### MVP (Минимально жизнеспособный продукт)

**Цель MVP:** Одна замкнутая сессия от начала до конца, которая передаёт core experience игры.

**Геймплей:**
- [ ] 1 полный трек с beatmap (30-60 секунд)
- [ ] Кор-механика: нажатие клавиш 1-5 в ритм музыки
- [ ] Система промахов / game over
- [ ] Экран результатов (score, misses)
- [ ] Рестарт трека

**Визуал:**
- [ ] 3D сцена: стол, нож (low-poly)
- [ ] Камера от первого лица за столом
- [ ] Нож двигается между пальцами в ритм
- [ ] Визуальный фидбек попадания / промаха (flash, тряска камеры)
- [ ] Тёмное освещение, хоррор-атмосфера

**Звук:**
- [ ] музыкальные треки
- [ ] Звук удара ножа (попадание)
- [ ] Звук промаха (порез)
- [ ] Фоновый эмбиент (опционально)

**Техническое:**
- [ ] Загрузка beatmap из JSON
- [ ] Синхронизация аудио с игровой логикой
- [+] Генератор beatmap (Python-скрипт) — готов

**НЕ входит в MVP:**
- Несколько треков
- Прогрессия механик между треками
- Меню / UI
- Сохранение прогресса
- Кастомизация ножа / скинов

### Дополнительные фичи (после MVP)
- [ ] 3-5 треков с нарастающей сложностью
- [ ] Новая механика на каждый трек
- [ ] Меню: старт, выбор трека, настройки
- [ ] Система HP / жизней вместо мгновенного game over
- [ ] Визуальные эффекты: кровь, царапины на столе
- [ ] Leaderboard / лучший результат
- [ ] Нарратив между треками (кто заставляет играть? почему?)

### Вне скоупа
- Мультиплеер
- Процедурная генерация beatmap в реальном времени
- Редактор уровней
- Мобильная версия
